<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>自动登录</title>
    <style>
        div.box{
            width:100%;
            height:100%;
        }
        div.margin-auto {
            width: 20rem;
            height: 100%;
            margin: 0 auto;
            font-size: 1.2rem;
        }

        input {
            height: 2rem;
            line-height: 2rem;
            width: 20rem;
            font-size: 1.2rem;
            border: 1px solid #000;
        }

        button {
            font-size: 1rem;
        }

        div.mask {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            z-index: 10000;
            position: absolute;
            top: 0;
            left: 0;
            background: #cdf;
            opacity: 0.2;
            display: none;
            color: red;
        }
    </style>
</head>
<body>
<center><h2>华中科技大学自动登录系统</h2></center>
<div class="box">
    <div class="margin-auto">
        <p>用户名</p>
        <p><input type="text" class="username" value="W201714333" /></p>

        <p>密码</p>
        <p><input type="text" class="password" value="420321199012032411" /></p>

        <p>登录次数</p>
        <p><input type="text" class="loginnum" value="1" /></p>
        <p style="font-size: 0.5rem;">建议一次填写10次以内,避免服务器压力过大,加载失败</p>

        <p><a href="javascript:;" onclick="login()">登录</a></p>
    </div>
    <div class="result margin-auto">
    </div>
</div>
<div class="mask">
    <br><br><br><br><br><br><br>
    <center><h2 id="second">数据加载中......</h2></center>
</div>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script>
    var c = 0
    var t

    function timedCount() {
        document.getElementById('second').innerHTML = "用时 "+c+" s"
        c = c + 1
        t = setTimeout("timedCount()", 1000)
    }

    function stopCount() {
        c = 0
        clearTimeout(t)
    }
    function login() {
//        var mask = $(".mask");
        $(".mask").show();
        timedCount()

//        clearInterval(interval);
//        return
        $(function () {
            var url = "http://127.0.0.1:5000/login";
//            var url = "http://tmp.cc/api";
            var param = {
                "username": $(".username").val().trim(),
                "password": $(".password").val().trim(),
                "loginnum": $(".loginnum").val().trim()
            };
            $.post(url, param, function (res) {
//                console.log(res)
                $(".result").html(res)
                stopCount()
                $(".mask").hide();
            });
        });
    }
</script>
</body>
</html>